"0","get_data <- function(data, type, subtype=NULL) {"
"0","  weeks <- c('March 15 - March 21\r\n\r\n', 'Mar 22 - Mar 28', 'Mar 29 - Apr 4', 'April 5 - 11', 'April 12 - 18', 'April 19 - 25', 'April 26 - May 2')"
"0","  if (is.null(subtype)) {"
"0","    smh <- data$smh_mh %>%"
"0","      filter(week %in% weeks) %>% "
"0","      filter(Type==type) %>% "
"0","      group_by(Year, week) %>% "
"0","      summarize(count=sum(count)) %>% "
"0","      mutate(date=paste(week, Year, sep=' '))"
"0","    grh <- data$grh_mh %>%"
"0","      filter(week %in% weeks) %>% "
"0","      filter(Type==type) %>% "
"0","      group_by(Year, week) %>% "
"0","      summarize(count=sum(count)) %>% "
"0","      mutate(date=paste(week, Year, sep=' '))"
"0","    cmh <- data$cmh_mh %>%"
"0","      filter(week %in% weeks) %>% "
"0","      filter(Type==type) %>% "
"0","      group_by(Year, week) %>% "
"0","      summarize(count=sum(count)) %>% "
"0","      mutate(date=paste(week, Year, sep=' '))"
"0","  } else {"
"0","    smh <- data$smh_mh %>%"
"0","      filter(week %in% weeks) %>% "
"0","      filter(Type==type, Subtype==subtype) %>% "
"0","      group_by(Year, week) %>% "
"0","      summarize(count=sum(count)) %>% "
"0","      mutate(date=paste(week, Year, sep=' '))"
"0","    grh <- data$grh_mh %>%"
"0","      filter(week %in% weeks) %>% "
"0","      filter(Type==type, Subtype==subtype) %>% "
"0","      group_by(Year, week) %>% "
"0","      summarize(count=sum(count)) %>% "
"0","      mutate(date=paste(week, Year, sep=' '))"
"0","    cmh <- data$cmh_mh %>%"
"0","      filter(week %in% weeks) %>% "
"0","      filter(Type==type, Subtype==subtype) %>% "
"0","      group_by(Year, week) %>% "
"0","      summarize(count=sum(count)) %>% "
"0","      mutate(date=paste(week, Year, sep=' '))"
"0","  }"
"0","  whole <- smh %>% "
"0","    left_join(grh, by='date') %>%"
"0","    left_join(cmh, by='date') %>% "
"0","    mutate(total=count+count.x+count.y) %>% "
"0","    select(Year, week, total) %>% "
"0","    mutate(Year=as.factor(Year))"
"0","  return(whole)"
"0","}"
